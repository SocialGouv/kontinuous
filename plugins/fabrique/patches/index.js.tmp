const processors = [
  "../charts/recommended/patches",
  "./rancher-project-id.js",
  "./cert-letsencrypt-issuer.js",
  "./cert-wildcard.js",
]

module.exports = async (data, _options, context, parentScope) => {
  for (const inc of processors) {
    const { config, getOptions, getScope } = context
    const scope = getScope({ scope: parentScope, inc, type: "patches" })
    const result = await require(inc)(
      data,
      getOptions({
        scope,
        inc,
        type: "patches",
        config,
      }),
      context,
      scope
    )
    if (result) {
      data = result
    }
  }
  return data
}
